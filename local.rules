# $Id: local.rules,v 1.11 2004/07/23 20:15:44 bmc Exp $
# ----------------
# LOCAL RULES
# ----------------

#Detect ICMP Ping Flood

alert icmp any any -> any any (msg:"ICMP Packet Detected"; sid:1000001; rev:1;)

# ----------------

alert tcp any any -> any 80 (msg:"Potential HTTP traffic detected"; sid:1000001; rev:1;)

# ----------------

alert tcp any any -> any 23 (msg:"Telnet Login Attempt Detected"; content:"login:"; nocase; sid:1000002; rev:1;)

# ----------------

alert tcp any any -> 192.168.10.5 80 (msg:"Suspicious HTTP POST to 192.168.20.143"; flow:to_server,established; content:"POST"; http_method; classtype:attempted-user; sid:1000003; rev:1;)

# ----------------

# Detect FTP Login Attempt

alert tcp any any -> any 21 (
  msg:"FTP Login Attempt Detected";
  content:"USER"; nocase;
  flow:to_server,established;
  sid:1000004; rev:1;
)

# ----------------

#Detect SSH Brute Force Attempt

alert tcp any any -> any 22 (
  msg:"SSH Brute Force Attempt";
  flags:S;
  threshold:type both, track by_src, count 10, seconds 30;
  sid:1000005; rev:1;
)

# ----------------

#Detect DNS Query for Malicious Domain

alert udp any any -> any 53 (
  msg:"Malicious DNS Query Detected";
  content:"bad-domain.com"; nocase;
  sid:1000006; rev:1;
)

# ----------------

# Detect SQL Injection Attempt

alert tcp any any -> any 80 (
  msg:"SQL Injection Attempt Detected";
  content:"' or 1=1 --"; nocase;
  flow:to_server,established;
  sid:1000007; rev:1;
)

# ----------------

#Detect Suspicious User-Agent in HTTP Headers

alert tcp any any -> any 80 (
  msg:"Suspicious User-Agent Detected";
  content:"User-Agent|3A| sqlmap"; nocase;
  http_header;
  sid:1000010; rev:1;
)

# ----------------





